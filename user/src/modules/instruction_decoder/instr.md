# RV32I 的基本指令类型

## R-type 指令

- **功能**：寄存器到寄存器的操作
- **指令格式**：

  ```text
  | 31  25 | 24 20 | 19 15 | 14  12 | 11 7 | 6    0 |
  | func7  |  rs2  |  rs1  | func3  |  rd  | opcode |
  ```

- **字段说明**：
- `func7`：功能码，用于区分不同的操作
- `rs2`：源寄存器 2
- `rs1`：源寄存器 1
- `func3`：功能码，用于区分不同的操作
- `rd`：目标寄存器
- `opcode`：操作码，指示指令类型
  - `0110011`: 寄存器到寄存器操作

## I-type 指令

- **功能**：立即数操作
- **指令格式**：

  ```text
  | 31     20 | 19 15 | 14  12 | 11 7 | 6    0 |
  | imm[11:0] |  rs1  | func3  |  rd  | opcode |
  ```

- **字段说明**：
- `imm[11:0]`：立即数
  - 对齐方式为作为有符号数扩展到 32 位
- `rs1`：源寄存器 1
- `func3`：功能码，用于区分不同的操作
- `rd`：目标寄存器
- `opcode`：操作码，指示指令类型
  - `0010011`：寄存器与立即数操作
    - 将 rs1 寄存器的值与立即数进行操作，结果存入 rd 寄存器
  - `0000011`：加载指令
    - 将 rs1 + imm 地址处的内存数据加载到 rd 寄存器
  - `1100111`：跳转指令
    - 将 rs1 + imm 的值写入 pc 寄存器，同时把 pc + 4 的值写入 rd 寄存器
  - `1110011`：系统指令
    - 用于系统调用和中断处理
  - `0001111`：FENCE 指令
    - 用于内存屏障操作

## S-type 指令

- **功能**：存储操作
- **指令格式**：

  ```text
  | 31     25 | 24 20 | 19 15 | 14  12 | 11      7 | 6    0 |
  | imm[11:5] | rs2   | rs1   | func3  | imm[4:0]  | opcode |
  ```

- **字段说明**：
- `rs2`：源寄存器 2
- `rs1`：源寄存器 1
- `funct3`：功能码，用于区分不同的操作
- `imm`：立即数
  - `imm[11:5]`：立即数的高 7 位
  - `imm[4:0]`：立即数的低 5 位
  - 对齐方式为作为有符号数扩展到 32 位
- `opcode`：操作码，指示指令类型
  - `0100011`：存储指令
    - 将 rs2 寄存器的值存储到 rs1 + imm 地址处的内存中

## B-type 指令

- **功能**：分支操作
- **指令格式**：

  ```text
  | 31           25 | 24 20 | 19 15 | 14  12 | 11        7 | 6    0 |
  |  imm[12|10:5]   | rs2   | rs1   | func3  | imm[4:1|11] | opcode |
  ```

- **字段说明**：
- `rs2`：源寄存器 2
- `rs1`：源寄存器 1
- `func3`：功能码，用于区分不同的操作
- `imm`：立即数

  - `imm[12|10:5]`：第 12 位和第 10-5 位
  - `imm[4:1|11]`：第 4-1 位和第 11 位
  - 对齐方式为最低位为 0，同时符号扩展到 32 位

  ```text
  immediate:
  Raw:    
  Target: 
  ```

- `opcode`：操作码，指示指令类型
  - `1100011`：分支指令
    - 判断 rs1 和 rs2 寄存器的值是否满足条件，如果满足，则跳转到 pc + imm 地址处

## U-type 指令

- **功能**：上位立即数操作
- **指令格式**：

  ```text
  | 31      12 | 11 7 | 6    0 |
  | imm[31:12] | rd   | opcode |
  ```

- **字段说明**：
  - `imm`：立即数
    - `imm[31:12]`：立即数的高 20 位
    - 对齐方式为低位补 0
  - `rd`：目标寄存器
  - `opcode`：操作码，指示指令类型
    - `0110111`：上位立即数加载指令
      - 将 imm 加载到 rd 寄存器中
    - `0010111`：上位立即数加法指令
      - 将 imm 与 pc 相加，结果存入 rd 寄存器

## J-type 指令

- **功能**：跳转操作
- **指令格式**：

  ```text
  | 31                 12 | 11 7 | 6    0 |
  | imm[20|10:1|11|19:12] | rd   | opcode |
  ```

- **字段说明**：
- `imm`：立即数
  - `imm[20|10:1|11|19:12]`：第 20 位、第 10-1 位、第 11 位和第 19-12 位
  - 对齐方式为最低位为 0，同时符号扩展到 32 位
- `rd`：目标寄存器
- `opcode`：操作码，指示指令类型
  - `1101111`：跳转指令
    - 将 pc + imm 的值写入 pc 寄存器，同时把 pc + 4 的值写入 rd 寄存器
